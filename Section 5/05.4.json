{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1481560479724_447705200","id":"20161212-173439_1765939612","dateCreated":"2016-12-12T17:34:39+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:121","text":"val tweets = spark.read.parquet(\"/dataset/twitter/reference\")\ntweets.select(\"favoriteCount\").rdd.map(_.getAs[Long](\"favoriteCount\")).sum\ntweets.select(\"createdAt\").rdd.map(_.getAs[Long](\"createdAt\")).mean","dateUpdated":"2016-12-12T17:34:55+0100","dateFinished":"2016-12-12T17:35:21+0100","dateStarted":"2016-12-12T17:34:55+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\ntweets: org.apache.spark.sql.DataFrame = [accessLevel: bigint, contributors: array<string> ... 33 more fields]\n\nres0: Double = 0.0\n\nres1: Double = 1.476772657470588E12\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1481560495637_1522155637","id":"20161212-173455_200796713","dateCreated":"2016-12-12T17:34:55+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:280","dateUpdated":"2016-12-12T17:35:00+0100","dateFinished":"2016-12-12T17:35:22+0100","dateStarted":"2016-12-12T17:35:00+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class SimpleTweet\n\nrdd: org.apache.spark.rdd.RDD[SimpleTweet] = MapPartitionsRDD[20] at map at <console>:29\n"},"text":"case class SimpleTweet(text: String, createdAt: Long, favoriteCount: Long)\n\nval rdd = tweets.rdd.map( u =>\n  SimpleTweet(\n    u.getAs[String](\"text\"),\n    u.getAs[Long](\"createdAt\"),\n    u.getAs[Long](\"favoriteCount\")\n  )\n)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1481560500873_-1982137345","id":"20161212-173500_1830984262","dateCreated":"2016-12-12T17:35:00+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:355","text":"class Extensions(rdd: org.apache.spark.rdd.RDD[SimpleTweet]) {\n  def favoriteCounts = rdd.map(_.favoriteCount).sum\n}","dateUpdated":"2016-12-12T17:35:05+0100","dateFinished":"2016-12-12T17:35:22+0100","dateStarted":"2016-12-12T17:35:22+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class Extensions\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1481560505426_-666680856","id":"20161212-173505_1097074849","dateCreated":"2016-12-12T17:35:05+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:423","text":"object Extensions {\n  implicit def addFavoriteCounts(rdd: org.apache.spark.rdd.RDD[SimpleTweet]) = new Extensions(rdd)\n}","dateUpdated":"2016-12-12T17:35:10+0100","dateFinished":"2016-12-12T17:35:22+0100","dateStarted":"2016-12-12T17:35:22+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\nwarning: there was one feature warning; re-run with -feature for details\n\ndefined object Extensions\n\nwarning: previously defined class Extensions is not a companion to object Extensions.\n\nCompanions must be defined together; you may wish to use :paste mode for this.\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1481560510788_172471819","id":"20161212-173510_2143527980","dateCreated":"2016-12-12T17:35:10+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:491","text":"import Extensions._\n\nprintln(rdd.favoriteCounts)","dateUpdated":"2016-12-12T17:35:15+0100","dateFinished":"2016-12-12T17:35:25+0100","dateStarted":"2016-12-12T17:35:22+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport Extensions._\n0.0\n"}},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1481560515535_-410792189","id":"20161212-173515_1469382188","dateCreated":"2016-12-12T17:35:15+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:559","dateUpdated":"2016-12-12T17:35:22+0100","dateFinished":"2016-12-12T17:35:25+0100","dateStarted":"2016-12-12T17:35:23+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class SimpleTweet2\n"},"text":"case class SimpleTweet2(text: String, createdAt: Long, favoriteCount: Long, cleanText: String = \"\")"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1481560522284_1423305818","id":"20161212-173522_186548902","dateCreated":"2016-12-12T17:35:22+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:633","dateUpdated":"2016-12-12T17:35:29+0100","dateFinished":"2016-12-12T17:35:29+0100","dateStarted":"2016-12-12T17:35:29+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\ndefined class CleanRDD\n"},"text":"class CleanRDD(prev:org.apache.spark.rdd.RDD[SimpleTweet2], pattern: String) extends org.apache.spark.rdd.RDD[SimpleTweet2](prev) {\n\n  override def compute(split: org.apache.spark.Partition, context: org.apache.spark.TaskContext): Iterator[SimpleTweet2] = {\n    firstParent[SimpleTweet2].iterator(split, context).map(simpleTweet => {\n      val cleanText = simpleTweet.text.replaceAll(pattern, \"\")\n      new SimpleTweet2(simpleTweet.text, simpleTweet.createdAt, simpleTweet.favoriteCount, cleanText)\n  })}\n\n  override protected def getPartitions: Array[org.apache.spark.Partition] = firstParent[SimpleTweet2].partitions\n\n}"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1481560529591_-1275707716","id":"20161212-173529_1115009059","dateCreated":"2016-12-12T17:35:29+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:722","dateUpdated":"2016-12-12T17:35:52+0100","dateFinished":"2016-12-12T17:35:52+0100","dateStarted":"2016-12-12T17:35:52+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\nwarning: there was one feature warning; re-run with -feature for details\n\n\ndefined class Extensions\ndefined object Extensions2\n\nwarning: previously defined object Extensions is not a companion to class Extensions.\n\nCompanions must be defined together; you may wish to use :paste mode for this.\n"},"text":"class Extensions(rdd: org.apache.spark.rdd.RDD[SimpleTweet2]) {\n  def clean(pattern: String) = new CleanRDD(rdd, pattern)\n}\nobject Extensions2 {\n  implicit def addClean(rdd: org.apache.spark.rdd.RDD[SimpleTweet2]) = new Extensions(rdd)\n}"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1481560552438_1439895993","id":"20161212-173552_107499578","dateCreated":"2016-12-12T17:35:52+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:802","dateUpdated":"2016-12-12T17:35:56+0100","dateFinished":"2016-12-12T17:35:58+0100","dateStarted":"2016-12-12T17:35:56+0100","result":{"code":"SUCCESS","type":"TEXT","msg":"\nimport Extensions2._\n\nrdd2: org.apache.spark.rdd.RDD[SimpleTweet2] = MapPartitionsRDD[23] at map at <console>:46\nRT @halsey: I do now! 🌹🌹🌹  https://t.co/m7cpvygHJo\n@andrew8088 hey can you please provide bookmarks.js file from \"Learning MongoDB(2013)\" course.  \nP.S I'm not user of tutsplus.\nmy check gonna be supa fat doe 🤑\nRT @lFRANKOCEANl: My biggest fear is being replaced.\nRT @63moonsofficial: A #ForcedMerger would be against 63k shareholders, their welfare should be the prime concern @AmitShah @arunjaitley ht…\nRT @ddree__: haunted houses more fun when u with a group😂😂😂\nRT @LeeJongSukWorld: #LeeJongSuk and #HanHyoJoo  for Dazed Korea ヽ(^0^)ﾉ https://t.co/4b3bVDcYgh\nRT @LAGalaxy: 😎👊🏾\n\n@TheRealAC3 is up for Player of the Year & you can vote for him here: https://t.co/43JhMzBVB2 (@Herbalife) https://t.co/…\nRT @LARRAYOX: @LARRAYOX IS IT JUST ME OR DOES IT LOOK LIKE IM FLOATING IN THE FIRST ONE\n@Gurmeetramrahim #LionHeartCrossed150Cr GOOD AFTERNOON DrMSG G\n\nres3: Array[Unit] = Array((), (), (), (), (), (), (), (), (), ())\n"},"text":"import Extensions2._\n\nval rdd2 = tweets.rdd.map( u =>\n  SimpleTweet2(\n    u.getAs[String](\"text\"),\n    u.getAs[Long](\"createdAt\"),\n    u.getAs[Long](\"favoriteCount\")\n  )\n)\n\nrdd2.clean(\"XXX\").take(10).map(r => println(r.cleanText))"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1481560556061_-73539259","id":"20161212-173556_2080779923","dateCreated":"2016-12-12T17:35:56+0100","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:876","dateUpdated":"2016-12-12T17:36:06+0100","text":""}],"name":"05.4","id":"2C5S6F6G9","angularObjects":{"2BXV59BJ5:shared_process":[],"2BZ7JWBYX:shared_process":[],"2BYKQAFE3:shared_process":[],"2BXX92DZZ:shared_process":[],"2BY8191PX:shared_process":[],"2C242HAW7:shared_process":[],"2BXRBYBNN:shared_process":[],"2C1F64B57:shared_process":[],"2BXESURSJ:shared_process":[],"2BZSUGKDS:shared_process":[],"2C26Y211G:shared_process":[],"2C1URPXW3:shared_process":[],"2BZN774H8:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}